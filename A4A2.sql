CREATE TABLE CHARTER2 (
CHAR_TRIP INT PRIMARY KEY,
CHAR_DATE DATE,
AC_NUMBER VARCHAR(10),
CHAR_DESTINATION VARCHAR(10),
CHAR_DISTANCE VARCHAR(4),
CHAR_HOURS_FLOWN DECIMAL(10,2),
CHAR_HOURS_WAIT DECIMAL(10,2),
CHAR_FUEL_GALLONS DECIMAL(10,2),
CHAR_OIL_WTS CHAR(1),
CUS_CODE CHAR(5),
);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10001, '2018-02-05', '2289L', 'ATL', 936, 5.1, 2.2, 354.1, 1, 10011);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10002, '2018-02-05', '2778V', 'BNA', 320, 1.6, 0, 7.6, 0, 10016);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10003, '2018-02-05', '4278Y', 'GNV', 1574, 7.8, 0, 339.8, 2, 10014);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10004, '2018-02-06', '1484P', 'STL', 472, 2.9, 4.9, 97.2, 1, 10019);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10005, '2018-02-06', '2289L', 'ATL', 1023, 5.7, 3.5, 397.7, 2, 10011);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10006, '2018-02-06', '4278Y', 'STL', 472, 2.6, 5.2, 117.1, 0, 10017);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10007, '2018-02-06', '2778V', 'GNV', 1574, 7.9, 0, 348.4, 2, 10012);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10008, '2018-02-07', '1484P', 'TYS', 644, 4.1, 0, 140.6, 1, 10014);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10009, '2018-02-07', '2289L', 'GNV', 1574, 6.6, 23.4, 459.9, 0, 10017);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10010, '2018-02-07', '4278Y', 'ATL', 998, 6.2, 3.2, 279.7, 0, 10016);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10011, '2018-02-07', '1484P', 'BNA', 352, 1.9, 5.3, 66.4, 1, 10012);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10012, '2018-02-08', '2778V', 'MOB', 884, 4.8, 4.2, 215.1, 0, 10010);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10013, '2018-02-08', '4278Y', 'TYS', 644, 3.9, 4.5, 174.3, 1, 10011);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10014, '2018-02-09', '4278Y', 'ATL', 936, 6.1, 2.1, 302.6, 0, 10017);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10015, '2018-02-09', '2289L', 'GNV', 1645, 6.7, 0, 459.5, 2, 10016);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10016, '2018-02-09', '2778V', 'MQY', 312, 1.5, 0, 67.2, 0, 10011);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (10017, '2018-02-10', '1484P', 'STL', 508, 3.1, 0, 105.5, 0, 10014);

INSERT INTO CHARTER2 (CHAR_TRIP, CHAR_DATE, AC_NUMBER, CHAR_DESTINATION, CHAR_DISTANCE, CHAR_HOURS_FLOWN, CHAR_HOURS_WAIT, CHAR_FUEL_GALLONS, CHAR_OIL_WTS, CUS_CODE)
VALUES (100018, '2018-02-10', '4278Y', 'TYS', 644, 3.8, 4.5, 167.4, 0, 10017);


CREATE TABLE PILOT6 (
EMP_NUM INT PRIMARY KEY,
PIL_LICENSE CHAR(3),
PIL_RATINGS VARCHAR(50),
PIL_MED_TYPE CHAR(1),
PIL_MED_DATE DATE,
PIL_PT135_DATE DATE,
);

INSERT INTO PILOT6 (EMP_NUM, PIL_LICENSE, PIL_RATINGS, PIL_MED_TYPE, PIL_MED_DATE, PIL_PT135_DATE)
VALUES (101, 'ATP', 'ATP/SEL/MEL/Instr/CFII', 1, '2018-01-20', '2018-01-20');

INSERT INTO PILOT6 (EMP_NUM, PIL_LICENSE, PIL_RATINGS, PIL_MED_TYPE, PIL_MED_DATE, PIL_PT135_DATE)
VALUES (104, 'ATP', 'ATP/SEL/MEL/Instr', 1, '2018-01-20', '2018-01-20');

INSERT INTO PILOT6 (EMP_NUM, PIL_LICENSE, PIL_RATINGS, PIL_MED_TYPE, PIL_MED_DATE, PIL_PT135_DATE)
VALUES (105, 'COM', 'COMM/SEL/MEL/Instr/CFI', 1, '2018-01-20', '2018-01-20');

INSERT INTO PILOT6 (EMP_NUM, PIL_LICENSE, PIL_RATINGS, PIL_MED_TYPE, PIL_MED_DATE, PIL_PT135_DATE)
VALUES (106, 'COM', 'COMM/SEL/MEL/Instr', 1, '2018-01-20', '2018-01-20');

INSERT INTO PILOT6 (EMP_NUM, PIL_LICENSE, PIL_RATINGS, PIL_MED_TYPE, PIL_MED_DATE, PIL_PT135_DATE)
VALUES (109, 'COM', 'ATP/SEL/MEL/SES/Instr/CFII', 1, '2018-01-20', '2018-01-20');

CREATE TABLE MODEL5 (
MOD_CODE VARCHAR(30) PRIMARY KEY,
MOD_MANUFACTURER VARCHAR(30),
MOD_NAME VARCHAR(30),
MOD_SEATS VARCHAR(2),
MOD_CHG_MILE DECIMAL (10,2),
);

INSERT INTO MODEL5 (MOD_CODE, MOD_MANUFACTURER, MOD_NAME, MOD_SEATS, MOD_CHG_MILE)
VALUES ('C-90A', 'Beechcraft', 'KingAir', 8, 2.67);

INSERT INTO MODEL5 (MOD_CODE, MOD_MANUFACTURER, MOD_NAME, MOD_SEATS, MOD_CHG_MILE)
VALUES ('PA23-250', 'Piper', 'Aztec', 6, 1.93);

INSERT INTO MODEL5 (MOD_CODE, MOD_MANUFACTURER, MOD_NAME, MOD_SEATS, MOD_CHG_MILE)
VALUES ('PA31-350', 'Piper', 'Navajo Chieftain', 10, 2.35);



CREATE TABLE CREW7 (
CHAR_TRIP CHAR(5),
EMP_NUM CHAR(3),
CREW_JOB VARCHAR(10)
);

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10001, 104, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10002, 101, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10003, 105, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10003, 109, 'Copilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10004, 106, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10005, 101, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10006, 109, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10007, 104, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10007, 105, 'Copilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10008, 106, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10009, 105, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10010, 108, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10011, 101, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10011, 104, 'Copilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10012, 101, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10013, 105, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10014, 106, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10015, 101, 'Copilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10015, 104, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10016, 105, 'Copilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10016, 109, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10017, 101, 'pilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10018, 104, 'Copilot');

INSERT INTO CREW7 (CHAR_TRIP, EMP_NUM, CREW_JOB)
VALUES (10018, 105, 'pilot');


CREATE TABLE AIRCRAFT8 (
AC_NUMBER CHAR(5) PRIMARY KEY,
MOD_CODE VARCHAR(10),
AC_TTAF DECIMAL(10,2),
AC_TTEL DECIMAL(10,2),
AC_TTER DECIMAL(10,2),
);

INSERT INTO AIRCRAFT8 (AC_NUMBER, MOD_CODE, AC_TTAF, AC_TTEL, AC_TTER)
VALUES ('1484P', 'PA23-250', 1833.1, 1833.1, 101.8);

INSERT INTO AIRCRAFT8 (AC_NUMBER, MOD_CODE, AC_TTAF, AC_TTEL, AC_TTER)
VALUES ('2289L', 'C-90A', 4243.8, 768.9, 1123.4);

INSERT INTO AIRCRAFT8 (AC_NUMBER, MOD_CODE, AC_TTAF, AC_TTEL, AC_TTER)
VALUES ('2778V', 'PA31-350', 7992.9, 1513.1, 789.5);

INSERT INTO AIRCRAFT8 (AC_NUMBER, MOD_CODE, AC_TTAF, AC_TTEL, AC_TTER)
VALUES ('4278Y', 'PA31-350', 2147.3, 622.1, 243.2);




--Question 35

ALTER TABLE MODEL5
ADD MOD_WAIT_CHG DECIMAL(10,2)

--Question 36

UPDATE MODEL5
SET MOD_WAIT_CHG = 100.00
WHERE MOD_CODE = 'C-90A'; 

UPDATE MODEL5
SET MOD_WAIT_CHG = 50.00
WHERE MOD_CODE = 'PA23-250'; 

UPDATE MODEL5
SET MOD_WAIT_CHG = 75.00
WHERE MOD_CODE = 'PA31-350'; 

SELECT * FROM MODEL5

--Question 37

ALTER TABLE CHARTER2
ADD CHAR_WAIT_CHG DECIMAL(10,2);

ALTER TABLE CHARTER2
ADD CHAR_FLT_CHG_HR DECIMAL(10,2);

ALTER TABLE CHARTER2
ADD CHAR_FLT_CHG DECIMAL(10,2);

ALTER TABLE CHARTER2
ADD CHAR_TAX_CHG DECIMAL(10,2);

ALTER TABLE CHARTER2
ADD CHAR_TOT_CHG DECIMAL(10,2);

ALTER TABLE CHARTER2
ADD CHAR_PYMT DECIMAL(10,2);

ALTER TABLE CHARTER2
ADD CHAR_BALANCE DECIMAL(10,2);

--Question 38


-- Creating a stored procedure
CREATE PROCEDURE UpdateCharWaitChg
AS
BEGIN
    UPDATE CHARTER2
    SET
        CHAR_WAIT_CHG =
            CASE
                WHEN MODEL5.MOD_CODE = 'C-90A' THEN ISNULL(MODEL5.MOD_WAIT_CHG, 0) * ISNULL(AIRCRAFT8.AC_TTAF, 0) / ISNULL(AIRCRAFT8.AC_TTEL, 1) * ISNULL(AIRCRAFT8.AC_TTER, 1) * ISNULL(CHARTER2.CHAR_HOURS_WAIT, 0)
                WHEN MODEL5.MOD_CODE = 'PA23-250' THEN ISNULL(MODEL5.MOD_WAIT_CHG, 0) * ISNULL(AIRCRAFT8.AC_TTAF, 0) / ISNULL(AIRCRAFT8.AC_TTEL, 1) * ISNULL(AIRCRAFT8.AC_TTER, 1) * ISNULL(CHARTER2.CHAR_HOURS_WAIT, 0)
                WHEN MODEL5.MOD_CODE = 'CPA31-350' THEN ISNULL(MODEL5.MOD_WAIT_CHG, 0) * ISNULL(AIRCRAFT8.AC_TTAF, 0) / ISNULL(AIRCRAFT8.AC_TTEL, 1) * ISNULL(AIRCRAFT8.AC_TTER, 1) * ISNULL(CHARTER2.CHAR_HOURS_WAIT, 0)
                ELSE 0 -- default value, adjust as needed
            END
    FROM CHARTER2
    JOIN AIRCRAFT8 ON CHARTER2.AC_NUMBER = AIRCRAFT8.AC_NUMBER
    JOIN MODEL5 ON AIRCRAFT8.MOD_CODE = MODEL5.MOD_CODE;
END;

EXEC UpdateCharWaitChg

--DROP PROCEDURE UpdateCharWaitChg

--Question 39


-- Creating a stored procedure
CREATE PROCEDURE UpdateCharFltChgHr
AS
BEGIN
 
    UPDATE CHARTER2
    SET
        CHAR_FLT_CHG_HR =
            CASE
                WHEN MODEL5.MOD_CODE = 'C-90A' THEN ISNULL(MODEL5.MOD_CHG_MILE, 0) * ISNULL(CHARTER2.char_distance, 0)
                WHEN MODEL5.MOD_CODE = 'PA23-250' THEN ISNULL(MODEL5.MOD_CHG_MILE, 0) * ISNULL(CHARTER2.char_distance, 0)
                WHEN MODEL5.MOD_CODE = 'CPA31-350' THEN ISNULL(MODEL5.MOD_CHG_MILE, 0) * ISNULL(CHARTER2.char_distance, 0)
                ELSE 0 -- Default value, so adjust as needed
            END
    FROM CHARTER2
    JOIN AIRCRAFT8 ON CHARTER2.AC_NUMBER = AIRCRAFT8.AC_NUMBER
    JOIN MODEL5 ON AIRCRAFT8.MOD_CODE = MODEL5.MOD_CODE;
END;

EXEC UpdateCharFltChgHr

--DROP PROCEDURE UpdateCharFltChgHr

--Question 40

UPDATE CHARTER2
SET CHAR_FLT_CHG = ISNULL(CHAR_HOURS_FLOWN, 0) * ISNULL(CHAR_FLT_CHG_HR, 0);

--Question 41

UPDATE CHARTER2
SET CHAR_TAX_CHG = ISNULL(CHAR_FLT_CHG,0) * 0.08;

--Question 42

UPDATE CHARTER2
SET CHAR_TOT_CHG = ISNULL(CHAR_FLT_CHG, 0) + ISNULL(CHAR_TAX_CHG, 0);

--Question 43

ALTER TABLE PILOT6
ADD PIL_PIC_HRS DECIMAL (10,2);

UPDATE PILOT6
SET PIL_PIC_HRS = ISNULL(PILOT6.PIL_PIC_HRS,0) + ISNULL(CHARTER2.CHAR_HOURS_FLOWN,0)
FROM PILOT6
JOIN CREW7 ON PILOT6.EMP_NUM = CREW7.EMP_NUM
JOIN CHARTER2 ON CREW7.CHAR_TRIP = CHARTER2.CHAR_TRIP
WHERE CREW7.CREW_JOB= 'pilot';

SELECT * FROM CREW7
SELECT * FROM PILOT6
SELECT * FROM CHARTER2
SELECT * FROM MODEL5